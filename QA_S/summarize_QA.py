from transformers import (
    AutoTokenizer,
    LEDForConditionalGeneration,
)
from datasets import load_dataset
import torch
import os

os.chdir('QA_S/')
device = 'cuda' if torch.cuda.is_available() else 'cpu'
PRIMER_path='./Summarize_model/'
TOKENIZER = AutoTokenizer.from_pretrained(PRIMER_path)
MODEL = LEDForConditionalGeneration.from_pretrained(PRIMER_path).to(device)
MODEL.gradient_checkpointing_enable()
PAD_TOKEN_ID = TOKENIZER.pad_token_id
DOCSEP_TOKEN_ID = TOKENIZER.convert_tokens_to_ids("<doc-sep>")


def process_document(documents):
    input_ids_all=[]
    doc = documents.replace("\n", " ")
    doc = " ".join(doc.split())

    input_ids = []
    input_ids.extend(
        TOKENIZER.encode(
            doc,
            truncation=True,
            max_length=4096 // len(documents),
        )[1:-1]
    )
    input_ids.append(DOCSEP_TOKEN_ID)
    input_ids = (
        [TOKENIZER.bos_token_id]
        + input_ids
        + [TOKENIZER.eos_token_id]
    )
    input_ids_all.append(torch.tensor(input_ids))
    input_ids_all = torch.nn.utils.rnn.pad_sequence(
        input_ids_all, batch_first=True, padding_value=PAD_TOKEN_ID
    )
    return input_ids_all



def process(document):
    input_ids=process_document(document).to(device)
    # get the input ids and attention masks together
    global_attention_mask = torch.zeros_like(input_ids).to(input_ids.device)
    # put global attention on <s> token

    global_attention_mask[:, 0] = 1
    global_attention_mask[input_ids == DOCSEP_TOKEN_ID] = 1
    generated_ids = MODEL.generate(
        input_ids=input_ids,
        global_attention_mask=global_attention_mask,
        use_cache=True,
        max_length=1024,
        num_beams=5,
    )
    generated_str = TOKENIZER.batch_decode(
            generated_ids.tolist(), skip_special_tokens=True
        )
    result={}
    result['generated_summaries'] = generated_str
    return result



def summarize(input_text):
    results = process(input_text)
    return results


def QA(question, context):
    import torch
    from transformers import AutoTokenizer, AutoModelForQuestionAnswering
    tokenizer = AutoTokenizer.from_pretrained("./roberta_QA") 
    model = AutoModelForQuestionAnswering.from_pretrained("./roberta_QA").to(device)

    inputs = tokenizer.encode_plus(question, context, return_tensors="pt", truncation=True).to(device)
    answer_start_scores, answer_end_scores = model(**inputs)["start_logits"], model(**inputs)["end_logits"]
    answer_start = torch.argmax(answer_start_scores)
    answer_end = torch.argmax(answer_end_scores) + 1  
    return tokenizer.convert_tokens_to_string(tokenizer.convert_ids_to_tokens(inputs["input_ids"][0][answer_start:answer_end]))



if __name__ == "__main__":
    #input = "'Nov 22, 2013 \n \n Ann Wojcicki \n \n CEO \n \n 23andMe, Inc. \n \n 1390 Shoreline Way \n \n Mountain View, CA 94043 \n \n Document Number: GEN1300666 \n \n Re: Personal Genome Service (PGS) \n \n WARNING LETTER \n \n Dear Ms. Wojcicki, \n \n The Food and Drug Administration (FDA) is sending you this letter because you are marketing the 23andMe Saliva Collection Kit and Personal Genome Service (PGS) without marketing clearance or approval in violation of the Federal Food, Drug and Cosmetic Act (the FD&C Act). \n \n This product is a device within the meaning of section 201(h) of the FD&C Act, 21 U.S.C. 321(h), because it is intended for use in the diagnosis of disease or other conditions or in the cure, mitigation, treatment, or prevention of disease, or is intended to affect the structure or function of the body. For example, your company’s website at www.23andme.com/health (most recently viewed on November 6, 2013) markets the PGS for providing “health reports on 254 diseases and conditions,” including categories such as “carrier status,” “health risks,” and “drug response,” and specifically as a “first step in prevention” that enables users to “take steps toward mitigating serious diseases” such as diabetes, coronary heart disease, and breast cancer. Most of the intended uses for PGS listed on your website, a list that has grown over time, are medical device uses under section 201(h) of the FD&C Act. Most of these uses have not been classified and thus require premarket approval or de novo classification, as FDA has explained to you on numerous occasions. \n \n Some of the uses for which PGS is intended are particularly concerning, such as assessments for BRCA-related genetic risk and drug responses (e.g., warfarin sensitivity, clopidogrel response, and 5-fluorouracil toxicity) because of the potential health consequences that could result from false positive or false negative assessments for high-risk indications such as these. For instance, if the BRCA-related risk assessment for breast or ovarian cancer reports a false positive, it could lead a patient to undergo prophylactic surgery, chemoprevention, intensive screening, or other morbidity-inducing actions, while a false negative could result in a failure to recognize an actual risk that may exist. Assessments for drug responses carry the risks that patients relying on such tests may begin to self-manage their treatments through dose changes or even abandon certain therapies depending on the outcome of the assessment. For example, false genotype results for your warfarin drug response test could have significant unreasonable risk of illness, injury, or death to the patient due to thrombosis or bleeding events that occur from treatment with a drug at a dose that does not provide the appropriately calibrated anticoagulant effect. These risks are typically mitigated by International Normalized Ratio (INR) management under a physician’s care. The risk of serious injury or death is known to be high when patients are either non-compliant or not properly dosed; combined with the risk that a direct-to-consumer test result may be used by a patient to self-manage, serious concerns are raised if test results are not adequately understood by patients or if incorrect test results are reported. \n \n Your company submitted 510(k)s for PGS on July 2, 2012 and September 4, 2012, for several of these indications for use. However, to date, your company has failed to address the issues described during previous interactions with the Agency or provide the additional information identified in our September 13, 2012 letter for (b)(4) and in our November 20, 2012 letter for (b)(4), as required under 21 CFR 807.87(1). Consequently, the 510(k)s are considered withdrawn, see 21 C.F.R. 807.87(1), as we explained in our letters to you on March 12, 2013 and May 21, 2013. To date, 23andMe has failed to provide adequate information to support a determination that the PGS is substantially equivalent to a legally marketed predicate for any of the uses for which you are marketing it; no other submission for the PGS device that you are marketing has been provided under section 510(k) of the Act, 21 U.S.C. § 360(k). \n \n The Office of In Vitro Diagnostics and Radiological Health (OIR) has a long history of working with companies to help them come into compliance with the FD&C Act. Since July of 2009, we have been diligently working to help you comply with regulatory requirements regarding safety and effectiveness and obtain marketing authorization for your PGS device. FDA has spent significant time evaluating the intended uses of the PGS to determine whether certain uses might be appropriately classified into class II, thus requiring only 510(k) clearance or de novo classification and not PMA approval, and we have proposed modifications to the device’s labeling that could mitigate risks and render certain intended uses appropriate for de novo classification. Further, we provided ample detailed feedback to 23andMe regarding the types of data it needs to submit for the intended uses of the PGS. As part of our interactions with you, including more than 14 face-to-face and teleconference meetings, hundreds of email exchanges, and dozens of written communications, we provided you with specific feedback on study protocols and clinical and analytical validation requirements, discussed potential classifications and regulatory pathways (including reasonable submission timelines), provided statistical advice, and discussed potential risk mitigation strategies. As discussed above, FDA is concerned about the public health consequences of inaccurate results from the PGS device; the main purpose of compliance with FDA’s regulatory requirements is to ensure that the tests work. \n \n However, even after these many interactions with 23andMe, we still do not have any assurance that the firm has analytically or clinically validated the PGS for its intended uses, which have expanded from the uses that the firm identified in its submissions. In your letter dated January 9, 2013, you stated that the firm is “completing the additional analytical and clinical validations for the tests that have been submitted” and is “planning extensive labeling studies that will take several months to complete.” Thus, months after you submitted your 510(k)s and more than 5 years after you began marketing, you still had not completed some of the studies and had not even started other studies necessary to support a marketing submission for the PGS. It is now eleven months later, and you have yet to provide FDA with any new information about these tests. You have not worked with us toward de novo classification, did not provide the additional information we requested necessary to complete review of your 510(k)s, and FDA has not received any communication from 23andMe since May. Instead, we have become aware that you have initiated new marketing campaigns, including television commercials that, together with an increasing list of indications, show that you plan to expand the PGS’s uses and consumer base without obtaining marketing authorization from FDA. \n \n Therefore, 23andMe must immediately discontinue marketing the PGS until such time as it receives FDA marketing authorization for the device. The PGS is in class III under section 513(f) of the FD&C Act, 21 U.S.C. 360c(f). Because there is no approved application for premarket approval in effect pursuant to section 515(a) of the FD&C Act, 21 U.S.C. 360e(a), or an approved application for an investigational device exemption (IDE) under section 520(g) of the FD&C Act, 21 U.S.C. 360j(g), the PGS is adulterated under section 501(f)(1)(B) of the FD&C Act, 21 U.S.C. 351(f)(1)(B). Additionally, the PGS is misbranded under section 502(o) of the Act, 21 U.S.C. § 352(o), because notice or other information respecting the device was not provided to FDA as required by section 510(k) of the Act, 21 U.S.C. § 360(k). \n \n Please notify this office in writing within fifteen (15) working days from the date you receive this letter of the specific actions you have taken to address all issues noted above. Include documentation of the corrective actions you have taken. If your actions will occur over time, please include a timetable for implementation of those actions. If corrective actions cannot be completed within 15 working days, state the reason for the delay and the time within which the actions will be completed. Failure to take adequate corrective action may result in regulatory action being initiated by the Food and Drug Administration without further notice. These actions include, but are not limited to, seizure, injunction, and civil money penalties. \n \n We have assigned a unique document number that is cited above. The requested information should reference this document number and should be submitted to: \n \n James L. Woods, WO66-5688 \n \n Deputy Director \n \n Patient Safety and Product Quality \n \n Office of In vitro Diagnostics and Radiological Health \n \n 10903 New Hampshire Avenue \n \n Silver Spring, MD 20993 ||||| The Food and Drug Administration has ordered the maker of a popular genetic-testing kit to halt sales of its heavily marketed product, saying the mail-order tests haven’t been proven effective and could dangerously mislead people about their health. \n \n The move came in a sharply worded letter to 23andMe, a California start-up backed by Google. The company says that its Personal Genome Service can detect more than 240 genetic conditions and traits, flagging a person’s vulnerability to heart disease, breast cancer and other illnesses. The privately held company, founded in 2006, is headed by biologist and businesswoman Anne Wojcicki, who is separated from Google co-founder Sergey Brin. \n \n The FDA said the company repeatedly has failed to provide the scientific data necessary to prove that its test works as advertised. \n \n Perhaps more significantly, the agency’s action underscores its unease about the potential consequences of direct-to-consumer genetic tests, which can provide people with detailed information but not necessarily the context necessary to interpret what it means or how they should proceed. \n \n It also highlighted a contentious debate that has unfolded in recent years over how and whether the government should police an individual’s access to information about his or her genes. \n \n In its letter, which was dated Nov. 22 but posted online Monday, the FDA said it was concerned about 23andMe’s direct-to-consumer test “because of the potential health consequences that could result from false positive or false negative assessments,” which could lead people into unnecessary or ineffective treatments. The agency also said that the company had failed to support its claims despite “more than 14 face-to-face and teleconference meetings” with FDA officials, as well as “hundreds of e-mail exchanges” and “ample detailed feedback.” \n \n “Since July of 2009, we have been diligently working to help you comply with regulatory requirements,” the FDA said. “However, even after these many interactions with 23andMe, we still do not have any assurance that the firm has analytically or clinically validated the [test] for its intended uses.” \n \n 23andMe isn’t the only firm offering direct-to-consumer genetic testing, but it’s the largest and best known. About half a million people have used the company’s DNA kit, which costs $99 online and requires customers to submit a saliva sample via mail. The company then sends recommendations, such as suggesting that a customer track the amount of gluten in his diet if his DNA shows an increased risk for celiac disease. \n \n In a statement Monday, 23andMe confirmed that it had received the FDA’s warning letter. “We recognize that we have not met the FDA’s expectations regarding timeline and communication regarding our submission. Our relationship with the FDA is extremely important to us and we are committed to fully engaging with them to address their concerns.” \n \n The company has 15 days to detail how it will go forward, or else it could face other regulatory actions such as civil fines or injunctions. \n \n David Kaufman, director of research at the Genetics and Public Policy Center at Johns Hopkins University, said the FDA’s scathing warning to 23andMe ultimately could be a positive development for the company and the genetic-testing industry, which until now has operated virtually without oversight. \n \n “In some ways, the industry has been both terrified and has been waiting for this day,” Kaufman said. “The companies want to know what they need to do. . . . It’s good that the feds are thinking about this actively.” \n \n He added that 23andMe had taken care not to be too specific when reporting results, but rather to explain to customers when they have an elevated risk for certain conditions based on their DNA. In addition, he said that the company’s quest for FDA approval, while clearly an effort that has been rocky, also is helping to create a regulatory structure that will govern such tests in the future. \n \n “There are a lot of fly-by-night operations out there, and this isn’t one, in my opinion,” Kaufman said. “I think they’re trying to do it the right way.” \n \n The FDA’s move toward regulating genetic tests marketed directly to consumers ramped up in 2010, when the agency sent letters to 23andMe and several other companies declaring that the tests are medical devices that must receive government approval. The agency also convened a public hearing on the matter. \n \n In the past, even as 23andMe sought the FDA’s blessing, Wojcicki and other company officials have spoken often about the democratization of health care and the right of people to their genetic information. \n \n “If you look back a few decades, people were not told about their diagnosis of cancer, and it was thought [that] we need to protect them from that information. Now, that seems ridiculous,” Joanna Mountain, 23andMe’s senior director of research, told The Washington Post in 2010. “The same thing goes for genetic information. We have many, many people who are very, very curious and want to know and are capable of handling this information.” \n \n In interviews Monday, FDA officials said they understand how rapidly the field of genetic testing is evolving and noted that the agency has approved a range of genetic tests for everything from bladder cancer to cystic fibrosis. Last week, the FDA approved several “next generation” gene-sequencing devices that will speed up testing and allow doctors to diagnose patients more quickly. \n \n But the agency has tread carefully when it comes to consumers taking at-home tests and receiving complex results without the help of a medical professional. \n \n “We don’t have any bias against genetic testing at all,” said Elizabeth Mansfield, director of personalized medicine in the FDA’s medical-device center. “We’re just very concerned about these tests that consumers can buy themselves, and their only interpretation [of the results] may come from a company.” \n \n \n \n The agency might eventually approve such tests, but only after it feels confident that they are accurate and that consumers understand the limitations. \n \n “We do believe there is a place for this. We think people have a right to their genetic information,” said Courtney Lias, director of the FDA’s division of chemistry and toxicology devices. “But when a company is providing these types of tests where they interpret the results, we need to understand that the test actually works and the information they provide is correct. . . . The majority of genetics is not so black and white.”'"

    #print(summarize(input))
    #input = 'i like swimming'
    #print(summarize(input))

    question = "who is the president of America?"
    #context = """Playing the woman card to be Madam President? Clinton says ''deal me in.'' Deborah Lutterbeck reports.
#Hillary Clinton, as she secures the numbers to make her the first woman to be the nominee of a major American party. And now Georgetown University Professor Michele Swers says Clinton will face a uniquely female balancing act. (SOUNDBITE) (English) MICHELE SWERS, PROFESSOR OF THE DEPARTMENT OF GOVERNMENT AT GEORGETOWN UNIVERSITY, SAYING: "As a woman you want to be tough and show that you can handle the job, but you don't want to be too tough. You need to show a feminine side as well, and that you care about people, and that you are empathetic because that is what we expect from women." Republican rival Donald Trump says Clinton should not count on women. (SOUNDBITE) (English) REPUBLICAN PRESIDENTIAL CANDIDATE DONALD TRUMP, SAYING: "She plays the woman card more than any human being I've ever seen in my life. And frankly, I don't even think women like her, from everything I see." (SOUNDBITE) (English) U.S. DEMOCRATIC PRESIDENTIAL CANDIDATE, HILLARY CLINTON "Donald Trump, says, 'There she goes playing the woman's card.' Well, I'll tell you what - if talking about paid family leave, equal pay, women's rights to make our health care decisions, then deal me in." Clinton was highly favored by older women in the primary season, but many younger women like 29-year old Jessica Forrester opted for Sen. Bernie Sanders. Forrester will happily back Clinton now that she has adopted some of Sanders positions, while noting that in some ways, Sanders had it easier. (SOUNDBITE) (English) JESSICA FORRESTER SAYING, "She didn't have the option to be a Bernie Sanders -- to walk around in an ill-fitting suit and have messy hair. She never would have been taken seriously. Whereas for Bernie, we say, 'Oh, he is so busy writing policy and saving the world that he just looks a mess and doesn't care about his appearance and that's fine.' We never would have given her that same luxury." Sloane Shearman is undecided (SOUNDBITE) (English) SLOANE SHEARMAN SAYING: "I might possibly, maybe in some world, vote for Hillary Clinton. It would not be because she is a woman. In fact, I think it would be disrespectful to vote for Hillary Clinton because she is a woman." First Lady Michelle Obama... (SOUNDBITE) (English) FIRST LADY MICHELLE OBAMA SAYING: "And because of Hillary Clinton, my daughters and all our sons and daughters now take for granted that a oman can be president of the United States."""
    #context += 'Hillary Clinton is 60 years old.'
    context = "WASHINGTON — Federal investigators working for Special Counsel Robert Mueller are keenly focused on President Donald Trump's role in crafting a response to a published article about a meeting between Russians and his son Donald Jr., three sources familiar with the matter told NBC News. The sources told NBC News that prosecutors want to know what Trump knew about the meeting and whether he sought to conceal its purpose. The meeting occurred at Trump Tower in June 2016 and was attended by Donald Trump Jr., Trump campaign chairman Paul Manafort, and Trump's son-in-law Jared Kushner. The meeting, which was first reported by The New York Times, also involved Russian attorney Natalia Veselnitskaya and former Soviet intelligence officer Rinat Akhmetshin. At the time, the White House confirmed that Trump had weighed in as the response to the Times report was drafted aboard Air Force One on July 8 as the president returned to the U.S. from the G20 meeting in Germany. The Washington Post reported that Trump had dictated the response."
    print(QA(question, context))from transformers import (
    AutoTokenizer,
    LEDForConditionalGeneration,
)
from datasets import load_dataset
import torch
import os

os.chdir('QA_S/')
device = 'cuda' if torch.cuda.is_available() else 'cpu'
PRIMER_path='./Summarize_model/'
TOKENIZER = AutoTokenizer.from_pretrained(PRIMER_path)
MODEL = LEDForConditionalGeneration.from_pretrained(PRIMER_path).to(device)
MODEL.gradient_checkpointing_enable()
PAD_TOKEN_ID = TOKENIZER.pad_token_id
DOCSEP_TOKEN_ID = TOKENIZER.convert_tokens_to_ids("<doc-sep>")


def process_document(documents):
    input_ids_all=[]
    doc = documents.replace("\n", " ")
    doc = " ".join(doc.split())

    input_ids = []
    input_ids.extend(
        TOKENIZER.encode(
            doc,
            truncation=True,
            max_length=4096 // len(documents),
        )[1:-1]
    )
    input_ids.append(DOCSEP_TOKEN_ID)
    input_ids = (
        [TOKENIZER.bos_token_id]
        + input_ids
        + [TOKENIZER.eos_token_id]
    )
    input_ids_all.append(torch.tensor(input_ids))
    input_ids_all = torch.nn.utils.rnn.pad_sequence(
        input_ids_all, batch_first=True, padding_value=PAD_TOKEN_ID
    )
    return input_ids_all



def process(document):
    input_ids=process_document(document).to(device)
    # get the input ids and attention masks together
    global_attention_mask = torch.zeros_like(input_ids).to(input_ids.device)
    # put global attention on <s> token

    global_attention_mask[:, 0] = 1
    global_attention_mask[input_ids == DOCSEP_TOKEN_ID] = 1
    generated_ids = MODEL.generate(
        input_ids=input_ids,
        global_attention_mask=global_attention_mask,
        use_cache=True,
        max_length=1024,
        num_beams=5,
    )
    generated_str = TOKENIZER.batch_decode(
            generated_ids.tolist(), skip_special_tokens=True
        )
    result={}
    result['generated_summaries'] = generated_str
    return result



def summarize(input_text):
    results = process(input_text)
    return results


def QA(question, context):
    import torch
    from transformers import AutoTokenizer, AutoModelForQuestionAnswering
    tokenizer = AutoTokenizer.from_pretrained("./roberta_QA") 
    model = AutoModelForQuestionAnswering.from_pretrained("./roberta_QA").to(device)

    inputs = tokenizer.encode_plus(question, context, return_tensors="pt", truncation=True).to(device)
    answer_start_scores, answer_end_scores = model(**inputs)["start_logits"], model(**inputs)["end_logits"]
    answer_start = torch.argmax(answer_start_scores)
    answer_end = torch.argmax(answer_end_scores) + 1  
    return tokenizer.convert_tokens_to_string(tokenizer.convert_ids_to_tokens(inputs["input_ids"][0][answer_start:answer_end]))



if __name__ == "__main__":
    #input = "'Nov 22, 2013 \n \n Ann Wojcicki \n \n CEO \n \n 23andMe, Inc. \n \n 1390 Shoreline Way \n \n Mountain View, CA 94043 \n \n Document Number: GEN1300666 \n \n Re: Personal Genome Service (PGS) \n \n WARNING LETTER \n \n Dear Ms. Wojcicki, \n \n The Food and Drug Administration (FDA) is sending you this letter because you are marketing the 23andMe Saliva Collection Kit and Personal Genome Service (PGS) without marketing clearance or approval in violation of the Federal Food, Drug and Cosmetic Act (the FD&C Act). \n \n This product is a device within the meaning of section 201(h) of the FD&C Act, 21 U.S.C. 321(h), because it is intended for use in the diagnosis of disease or other conditions or in the cure, mitigation, treatment, or prevention of disease, or is intended to affect the structure or function of the body. For example, your company’s website at www.23andme.com/health (most recently viewed on November 6, 2013) markets the PGS for providing “health reports on 254 diseases and conditions,” including categories such as “carrier status,” “health risks,” and “drug response,” and specifically as a “first step in prevention” that enables users to “take steps toward mitigating serious diseases” such as diabetes, coronary heart disease, and breast cancer. Most of the intended uses for PGS listed on your website, a list that has grown over time, are medical device uses under section 201(h) of the FD&C Act. Most of these uses have not been classified and thus require premarket approval or de novo classification, as FDA has explained to you on numerous occasions. \n \n Some of the uses for which PGS is intended are particularly concerning, such as assessments for BRCA-related genetic risk and drug responses (e.g., warfarin sensitivity, clopidogrel response, and 5-fluorouracil toxicity) because of the potential health consequences that could result from false positive or false negative assessments for high-risk indications such as these. For instance, if the BRCA-related risk assessment for breast or ovarian cancer reports a false positive, it could lead a patient to undergo prophylactic surgery, chemoprevention, intensive screening, or other morbidity-inducing actions, while a false negative could result in a failure to recognize an actual risk that may exist. Assessments for drug responses carry the risks that patients relying on such tests may begin to self-manage their treatments through dose changes or even abandon certain therapies depending on the outcome of the assessment. For example, false genotype results for your warfarin drug response test could have significant unreasonable risk of illness, injury, or death to the patient due to thrombosis or bleeding events that occur from treatment with a drug at a dose that does not provide the appropriately calibrated anticoagulant effect. These risks are typically mitigated by International Normalized Ratio (INR) management under a physician’s care. The risk of serious injury or death is known to be high when patients are either non-compliant or not properly dosed; combined with the risk that a direct-to-consumer test result may be used by a patient to self-manage, serious concerns are raised if test results are not adequately understood by patients or if incorrect test results are reported. \n \n Your company submitted 510(k)s for PGS on July 2, 2012 and September 4, 2012, for several of these indications for use. However, to date, your company has failed to address the issues described during previous interactions with the Agency or provide the additional information identified in our September 13, 2012 letter for (b)(4) and in our November 20, 2012 letter for (b)(4), as required under 21 CFR 807.87(1). Consequently, the 510(k)s are considered withdrawn, see 21 C.F.R. 807.87(1), as we explained in our letters to you on March 12, 2013 and May 21, 2013. To date, 23andMe has failed to provide adequate information to support a determination that the PGS is substantially equivalent to a legally marketed predicate for any of the uses for which you are marketing it; no other submission for the PGS device that you are marketing has been provided under section 510(k) of the Act, 21 U.S.C. § 360(k). \n \n The Office of In Vitro Diagnostics and Radiological Health (OIR) has a long history of working with companies to help them come into compliance with the FD&C Act. Since July of 2009, we have been diligently working to help you comply with regulatory requirements regarding safety and effectiveness and obtain marketing authorization for your PGS device. FDA has spent significant time evaluating the intended uses of the PGS to determine whether certain uses might be appropriately classified into class II, thus requiring only 510(k) clearance or de novo classification and not PMA approval, and we have proposed modifications to the device’s labeling that could mitigate risks and render certain intended uses appropriate for de novo classification. Further, we provided ample detailed feedback to 23andMe regarding the types of data it needs to submit for the intended uses of the PGS. As part of our interactions with you, including more than 14 face-to-face and teleconference meetings, hundreds of email exchanges, and dozens of written communications, we provided you with specific feedback on study protocols and clinical and analytical validation requirements, discussed potential classifications and regulatory pathways (including reasonable submission timelines), provided statistical advice, and discussed potential risk mitigation strategies. As discussed above, FDA is concerned about the public health consequences of inaccurate results from the PGS device; the main purpose of compliance with FDA’s regulatory requirements is to ensure that the tests work. \n \n However, even after these many interactions with 23andMe, we still do not have any assurance that the firm has analytically or clinically validated the PGS for its intended uses, which have expanded from the uses that the firm identified in its submissions. In your letter dated January 9, 2013, you stated that the firm is “completing the additional analytical and clinical validations for the tests that have been submitted” and is “planning extensive labeling studies that will take several months to complete.” Thus, months after you submitted your 510(k)s and more than 5 years after you began marketing, you still had not completed some of the studies and had not even started other studies necessary to support a marketing submission for the PGS. It is now eleven months later, and you have yet to provide FDA with any new information about these tests. You have not worked with us toward de novo classification, did not provide the additional information we requested necessary to complete review of your 510(k)s, and FDA has not received any communication from 23andMe since May. Instead, we have become aware that you have initiated new marketing campaigns, including television commercials that, together with an increasing list of indications, show that you plan to expand the PGS’s uses and consumer base without obtaining marketing authorization from FDA. \n \n Therefore, 23andMe must immediately discontinue marketing the PGS until such time as it receives FDA marketing authorization for the device. The PGS is in class III under section 513(f) of the FD&C Act, 21 U.S.C. 360c(f). Because there is no approved application for premarket approval in effect pursuant to section 515(a) of the FD&C Act, 21 U.S.C. 360e(a), or an approved application for an investigational device exemption (IDE) under section 520(g) of the FD&C Act, 21 U.S.C. 360j(g), the PGS is adulterated under section 501(f)(1)(B) of the FD&C Act, 21 U.S.C. 351(f)(1)(B). Additionally, the PGS is misbranded under section 502(o) of the Act, 21 U.S.C. § 352(o), because notice or other information respecting the device was not provided to FDA as required by section 510(k) of the Act, 21 U.S.C. § 360(k). \n \n Please notify this office in writing within fifteen (15) working days from the date you receive this letter of the specific actions you have taken to address all issues noted above. Include documentation of the corrective actions you have taken. If your actions will occur over time, please include a timetable for implementation of those actions. If corrective actions cannot be completed within 15 working days, state the reason for the delay and the time within which the actions will be completed. Failure to take adequate corrective action may result in regulatory action being initiated by the Food and Drug Administration without further notice. These actions include, but are not limited to, seizure, injunction, and civil money penalties. \n \n We have assigned a unique document number that is cited above. The requested information should reference this document number and should be submitted to: \n \n James L. Woods, WO66-5688 \n \n Deputy Director \n \n Patient Safety and Product Quality \n \n Office of In vitro Diagnostics and Radiological Health \n \n 10903 New Hampshire Avenue \n \n Silver Spring, MD 20993 ||||| The Food and Drug Administration has ordered the maker of a popular genetic-testing kit to halt sales of its heavily marketed product, saying the mail-order tests haven’t been proven effective and could dangerously mislead people about their health. \n \n The move came in a sharply worded letter to 23andMe, a California start-up backed by Google. The company says that its Personal Genome Service can detect more than 240 genetic conditions and traits, flagging a person’s vulnerability to heart disease, breast cancer and other illnesses. The privately held company, founded in 2006, is headed by biologist and businesswoman Anne Wojcicki, who is separated from Google co-founder Sergey Brin. \n \n The FDA said the company repeatedly has failed to provide the scientific data necessary to prove that its test works as advertised. \n \n Perhaps more significantly, the agency’s action underscores its unease about the potential consequences of direct-to-consumer genetic tests, which can provide people with detailed information but not necessarily the context necessary to interpret what it means or how they should proceed. \n \n It also highlighted a contentious debate that has unfolded in recent years over how and whether the government should police an individual’s access to information about his or her genes. \n \n In its letter, which was dated Nov. 22 but posted online Monday, the FDA said it was concerned about 23andMe’s direct-to-consumer test “because of the potential health consequences that could result from false positive or false negative assessments,” which could lead people into unnecessary or ineffective treatments. The agency also said that the company had failed to support its claims despite “more than 14 face-to-face and teleconference meetings” with FDA officials, as well as “hundreds of e-mail exchanges” and “ample detailed feedback.” \n \n “Since July of 2009, we have been diligently working to help you comply with regulatory requirements,” the FDA said. “However, even after these many interactions with 23andMe, we still do not have any assurance that the firm has analytically or clinically validated the [test] for its intended uses.” \n \n 23andMe isn’t the only firm offering direct-to-consumer genetic testing, but it’s the largest and best known. About half a million people have used the company’s DNA kit, which costs $99 online and requires customers to submit a saliva sample via mail. The company then sends recommendations, such as suggesting that a customer track the amount of gluten in his diet if his DNA shows an increased risk for celiac disease. \n \n In a statement Monday, 23andMe confirmed that it had received the FDA’s warning letter. “We recognize that we have not met the FDA’s expectations regarding timeline and communication regarding our submission. Our relationship with the FDA is extremely important to us and we are committed to fully engaging with them to address their concerns.” \n \n The company has 15 days to detail how it will go forward, or else it could face other regulatory actions such as civil fines or injunctions. \n \n David Kaufman, director of research at the Genetics and Public Policy Center at Johns Hopkins University, said the FDA’s scathing warning to 23andMe ultimately could be a positive development for the company and the genetic-testing industry, which until now has operated virtually without oversight. \n \n “In some ways, the industry has been both terrified and has been waiting for this day,” Kaufman said. “The companies want to know what they need to do. . . . It’s good that the feds are thinking about this actively.” \n \n He added that 23andMe had taken care not to be too specific when reporting results, but rather to explain to customers when they have an elevated risk for certain conditions based on their DNA. In addition, he said that the company’s quest for FDA approval, while clearly an effort that has been rocky, also is helping to create a regulatory structure that will govern such tests in the future. \n \n “There are a lot of fly-by-night operations out there, and this isn’t one, in my opinion,” Kaufman said. “I think they’re trying to do it the right way.” \n \n The FDA’s move toward regulating genetic tests marketed directly to consumers ramped up in 2010, when the agency sent letters to 23andMe and several other companies declaring that the tests are medical devices that must receive government approval. The agency also convened a public hearing on the matter. \n \n In the past, even as 23andMe sought the FDA’s blessing, Wojcicki and other company officials have spoken often about the democratization of health care and the right of people to their genetic information. \n \n “If you look back a few decades, people were not told about their diagnosis of cancer, and it was thought [that] we need to protect them from that information. Now, that seems ridiculous,” Joanna Mountain, 23andMe’s senior director of research, told The Washington Post in 2010. “The same thing goes for genetic information. We have many, many people who are very, very curious and want to know and are capable of handling this information.” \n \n In interviews Monday, FDA officials said they understand how rapidly the field of genetic testing is evolving and noted that the agency has approved a range of genetic tests for everything from bladder cancer to cystic fibrosis. Last week, the FDA approved several “next generation” gene-sequencing devices that will speed up testing and allow doctors to diagnose patients more quickly. \n \n But the agency has tread carefully when it comes to consumers taking at-home tests and receiving complex results without the help of a medical professional. \n \n “We don’t have any bias against genetic testing at all,” said Elizabeth Mansfield, director of personalized medicine in the FDA’s medical-device center. “We’re just very concerned about these tests that consumers can buy themselves, and their only interpretation [of the results] may come from a company.” \n \n \n \n The agency might eventually approve such tests, but only after it feels confident that they are accurate and that consumers understand the limitations. \n \n “We do believe there is a place for this. We think people have a right to their genetic information,” said Courtney Lias, director of the FDA’s division of chemistry and toxicology devices. “But when a company is providing these types of tests where they interpret the results, we need to understand that the test actually works and the information they provide is correct. . . . The majority of genetics is not so black and white.”'"

    #print(summarize(input))
    #input = 'i like swimming'
    #print(summarize(input))

    question = "who is the president of America?"
    #context = """Playing the woman card to be Madam President? Clinton says ''deal me in.'' Deborah Lutterbeck reports.
#Hillary Clinton, as she secures the numbers to make her the first woman to be the nominee of a major American party. And now Georgetown University Professor Michele Swers says Clinton will face a uniquely female balancing act. (SOUNDBITE) (English) MICHELE SWERS, PROFESSOR OF THE DEPARTMENT OF GOVERNMENT AT GEORGETOWN UNIVERSITY, SAYING: "As a woman you want to be tough and show that you can handle the job, but you don't want to be too tough. You need to show a feminine side as well, and that you care about people, and that you are empathetic because that is what we expect from women." Republican rival Donald Trump says Clinton should not count on women. (SOUNDBITE) (English) REPUBLICAN PRESIDENTIAL CANDIDATE DONALD TRUMP, SAYING: "She plays the woman card more than any human being I've ever seen in my life. And frankly, I don't even think women like her, from everything I see." (SOUNDBITE) (English) U.S. DEMOCRATIC PRESIDENTIAL CANDIDATE, HILLARY CLINTON "Donald Trump, says, 'There she goes playing the woman's card.' Well, I'll tell you what - if talking about paid family leave, equal pay, women's rights to make our health care decisions, then deal me in." Clinton was highly favored by older women in the primary season, but many younger women like 29-year old Jessica Forrester opted for Sen. Bernie Sanders. Forrester will happily back Clinton now that she has adopted some of Sanders positions, while noting that in some ways, Sanders had it easier. (SOUNDBITE) (English) JESSICA FORRESTER SAYING, "She didn't have the option to be a Bernie Sanders -- to walk around in an ill-fitting suit and have messy hair. She never would have been taken seriously. Whereas for Bernie, we say, 'Oh, he is so busy writing policy and saving the world that he just looks a mess and doesn't care about his appearance and that's fine.' We never would have given her that same luxury." Sloane Shearman is undecided (SOUNDBITE) (English) SLOANE SHEARMAN SAYING: "I might possibly, maybe in some world, vote for Hillary Clinton. It would not be because she is a woman. In fact, I think it would be disrespectful to vote for Hillary Clinton because she is a woman." First Lady Michelle Obama... (SOUNDBITE) (English) FIRST LADY MICHELLE OBAMA SAYING: "And because of Hillary Clinton, my daughters and all our sons and daughters now take for granted that a oman can be president of the United States."""
    #context += 'Hillary Clinton is 60 years old.'
    context = "WASHINGTON — Federal investigators working for Special Counsel Robert Mueller are keenly focused on President Donald Trump's role in crafting a response to a published article about a meeting between Russians and his son Donald Jr., three sources familiar with the matter told NBC News. The sources told NBC News that prosecutors want to know what Trump knew about the meeting and whether he sought to conceal its purpose. The meeting occurred at Trump Tower in June 2016 and was attended by Donald Trump Jr., Trump campaign chairman Paul Manafort, and Trump's son-in-law Jared Kushner. The meeting, which was first reported by The New York Times, also involved Russian attorney Natalia Veselnitskaya and former Soviet intelligence officer Rinat Akhmetshin. At the time, the White House confirmed that Trump had weighed in as the response to the Times report was drafted aboard Air Force One on July 8 as the president returned to the U.S. from the G20 meeting in Germany. The Washington Post reported that Trump had dictated the response."
    print(QA(question, context))
